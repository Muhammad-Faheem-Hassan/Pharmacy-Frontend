<div class="container mt-4">
    <h3 class="mb-3">New Sale</h3>
  
    <form [formGroup]="saleForm" (ngSubmit)="submitSale()">
      <div class="row mb-3">
        <div class="col-md-6">
          <label>Customer Name</label>
          <input formControlName="customer" class="form-control" />
        </div>
        <div class="col-md-6">
          <label>Date</label>
          <input type="date" formControlName="date" class="form-control" />
        </div>
      </div>
  
      <div formArrayName="items">
        <div
          *ngFor="let item of items.controls; let i = index"
          [formGroupName]="i"
          class="row align-items-end mb-2"
        >
          <div class="col-md-4">
            <label>Medicine</label>
            <select formControlName="medicine" class="form-control">
              <option value="">-- Select Medicine --</option>
              <option *ngFor="let med of medicines" [value]="med._id">
                {{ med.name }}
              </option>
            </select>
          </div>
  
          <div class="col-md-2">
            <label>Quantity</label>
            <input type="number" formControlName="quantity" class="form-control" />
          </div>
  
          <div class="col-md-2">
            <label>Price</label>
            <input type="number" formControlName="price" class="form-control" />
          </div>
  
          <div class="col-md-2">
            <label>Total</label>
            <div class="form-control bg-light">
              {{
                item.value.quantity && item.value.price
                  ? item.value.quantity * item.value.price
                  : 0
              }}
            </div>
          </div>
  
          <div class="col-md-2 text-end">
            <div class="d-flex flex-row">
              <button type="button" class="btn btn-danger" (click)="removeItem(i)">
                Remove
              </button>
              <button *ngIf="i === items.controls.length - 1" type="button" class="btn btn-secondary ms-1"
                (click)="addItem()">
                <i class="bi bi-plus-lg me-1"></i> Add
              </button>
            </div>
          </div>
        </div>
      </div>
  
      <div class="mt-3">
        <h5>Total Amount: Rs {{ totalAmount }}</h5>
        <button class="btn btn-primary mt-2" [disabled]="saleForm.invalid">
          Save Sale
        </button>
      </div>
    </form>
  </div>
  